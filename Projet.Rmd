---
title: " Income Disparity-USA Bayesian Analysis"
author: "Taqwa Ben Romdhane"
        "Khalil Ounis"
        "Manal Derghal"
        "Fanny Sammut"
        "Alix Madrange"
date: "2025-03-25"
output: ioslides_presentation:
  toc: true
  toc_depth : 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

### 1. Introdcution :

\@ While the gender pay gap is persistent and significant, people of all genders are subject to disparities in pay. Another ongoing discussion in the United States is that of the racial wage gap,[given the disparities in median household income across racial and ethnic groups].Black American households had a median income of 56,490 U.S. dollars in 2023, significantly lower than the median income of white households which stood at 89,050 U.S. dollars in the same year. Wage inequality in the U.S. - statistics & facts. Statistica

A partir d'un échantillon de 534 américains décrits par 11 covariables, nous allons mener une analyse bayésienne de la disparité des revenus de la population aux étas unis.

Dans notre analyse, nous nous concentrons principalement sur l'étude des questions suivantes :

-   Comment les salaires horaires diffèrent-ils entre les hommes et les          femmes ayant des caractéristiques observées similaires ?

-   Disparités de revenus parmi les ethnicités
-   Disparité des revenues entre les femmes mariées et célibataires
-   Quels facteurs expliquent les disparités de revenus observées ?

## 2. Table de contenus :

-   Bullet 1
-   Bullet 2
-   Bullet 3

## Slide with R Output

```{r}
# Charger les bibliothèques nécessaires
library(dplyr)
library(ggplot2)
library(tidyverse)
library(runjags)
```

```{r cars, echo = TRUE}
Wage_data = read.csv("C:/Users/khali/Desktop/Polytech S9/M2DS/Bayesian Stat/Wage/wage_data.csv", header=TRUE, sep=",")
```


1. Prétraitement des données
```{r}

# check the data
selected_data1 <- Wage_data %>% select(education, south, female, workexp, unionmember, wages)
selected_data2 <- Wage_data %>% select(age, ethnicity, occupation, sector, married)
as.data.frame(head(glimpse(selected_data1), n=5))
as.data.frame(head(glimpse(selected_data2), n=5))
```

Notre jeu de données Wage_data contient les variables suivantes :
* education: Années d'études
* south: Indicateur de la région sud
* female: Indicateur de genre (0 = Homme, 1 = Femme)
* workexp: Années d'expérience professionnelle
* unionmember: Indicateur de membre du syndicat
* wages: Salaire horaire
* age: Âge
* ethnicity: Ethnicité (White, Hispanic, Other)
* occupation: Occupation (Management, Sales, Clerical, Professional, Service, Other)
* sector: Secteur d'activité (Manufactoring, Construction, Other)
* married: Indicateur de statut marital


```{r}
# copy <- Wage_data

age_bins <- c(18,30, 45, 60, Inf)
age_labels <- c("Y18-30", "Y30-45", "Y45-60", "Y60+")

# Transformer la variable age en catégories
Wage_data$age_group<- cut(Wage_data$age, breaks = age_bins, labels = age_labels, right = FALSE)

# Convertir en factors
Wage_data[c("south", "female", "unionmember", "ethnicity", "occupation", "sector","married")] <- lapply(Wage_data[c("south", "female", "unionmember", "ethnicity", "occupation", "sector","married")], factor)

```

```{r}
min(Wage_data$education) # 2
max(Wage_data$education) # 18
min(Wage_data$workexp) # 0
max(Wage_data$workexp)  # 55
```

2. Analyse descriptive et visualisation

```{r}
# Liste des variables quantitatives
numeric_vars <- c("education", "workexp", 
                  "wages","age")
Wage_data[numeric_vars] <- lapply(Wage_data[numeric_vars], function(x) as.numeric(as.character(x)))
# Boucle pour afficher les distributions
for (var in numeric_vars) {
  print(
    ggplot(Wage_data, aes_string(x = var)) +
      geom_histogram(aes(y = ..density..), bins = 30, fill = "skyblue", color = "black") +
      geom_density(color = "blue", size = 1) +
      labs(title = paste("Distribution de la variable :", var),
           x = var,
           y = "Densité") +
      theme_minimal()
  )
}

cat_vars <- c("south", "female", "unionmember", "ethnicity", "occupation", "sector", "married", "age_group")

for (var in cat_vars) {
  print(
    ggplot(Wage_data, aes_string(x = var)) +
      geom_bar(fill = "purple") +
      labs(title = paste("Distribution de la variable :", var),
           x = var, y = "Effectif") +
      theme_minimal()
  )
}

```
#Model + MCMC diagnostic (age)
```{r}
# Load libraries
library(runjags)
library(coda)
library(ggplot2)
library(dplyr)

# ---- Step 1: Prepare the data ----

# Clean data: keep only positive wages
Wage_data <- Wage_data %>% filter(wages > 0)

# Reindex age groups numerically (1 to K)
age_group_labels <- unique(Wage_data$age_group)
Wage_data$age_index <- as.numeric(factor(Wage_data$age_group, levels = age_group_labels))

# Constants
N <- nrow(Wage_data)
K <- length(unique(Wage_data$age_index))

# Create JAGS data list
data_jags <- list(
  N = N,
  K = K,
  wages = Wage_data$wages,
  alpha = rep(1, K)  # Non-informative Dirichlet prior
)

# ---- Step 2: JAGS Model ----

model_string <- "
model {
  for (i in 1:N) {
    age_group[i] ~ dcat(p[1:K])
    wages[i] ~ dnorm(mu[age_group[i]], tau)
  }

  # Prior over age group probabilities
  p[1:K] ~ ddirch(alpha[1:K])

  # Priors over wage means for each group
  mu[1] ~ dnorm(20, 1)
  mu[2] ~ dnorm(30, 1)
  mu[3] ~ dnorm(40, 1)
  mu[4] ~ dnorm(50, 1)


  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

# ---- Step 3: Initial values and parameters to monitor ----

inits <- function() {
  list(age_group = sample(1:K, N, replace = TRUE))
}

monitor_vars <- c("p", "mu", "tau", "sigma")

# ---- Step 4: Run the model ----

model <- run.jags(
  model = model_string,
  data = data_jags,
  inits = inits,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = TRUE,
  method = "rjags"
)

# ---- Step 5: Summarize and extract ----

print(summary(model))

mcmc_samples <- as.mcmc.list(model)
nchains <- length(mcmc_samples)

# Combine all chains into one long-format data frame
samples_df <- do.call(rbind, lapply(1:nchains, function(i) {
  df <- as.data.frame(mcmc_samples[[i]])
  df$iteration <- 1:nrow(df)
  df$chain <- factor(paste0("Chain ", i))
  return(df)
}))

# ---- Step 6: Traceplots for posterior over age group proportions ----

for (i in 1:K) {
  param <- paste0("p[", i, "]")
  if (param %in% names(samples_df)) {
    p <- ggplot(samples_df, aes(x = iteration, y = .data[[param]], color = chain)) +
      geom_line() +
      labs(title = paste("Traceplot for", param),
           x = "Iteration", y = "Posterior probability") +
      theme_minimal()
    print(p)
  }
}

# ---- Step 7 : traceplots for mu, tau, sigma ----

# List of parameters to plot
target_params <- c(paste0("mu[", 1:K, "]"), "tau", "sigma")

# Loop and generate traceplots
for (param in target_params) {
  if (param %in% names(samples_df)) {
    p <- ggplot(samples_df, aes(x = iteration, y = .data[[param]], color = chain)) +
      geom_line() +
      labs(title = paste("Traceplot for", param),
           x = "Iteration", y = "Value") +
      theme_minimal()
    print(p)
  }
}


```




# Fake data check for age
```{r}
# ---- Libraries ----
library(runjags)
library(coda)
library(ggplot2)
library(dplyr)

# ---- Step 1: Fake Data Simulation ----

set.seed(42)

# Define constants
k <- 4                   # number of groups
n <- 500                 # sample size
true_mu <- c(20, 30, 40, 50)
true_sigma <- 5
true_tau <- 1 / (true_sigma^2)

# Get true proportions from real data
true_p <- prop.table(table(Wage_data$age_group))

# Simulate group assignments
age_group_fake <- sample(1:k, size = n, replace = TRUE, prob = true_p)

# Simulate wages based on group assignment
wages_fake <- rnorm(n, mean = true_mu[age_group_fake], sd = true_sigma)

# Prepare data for JAGS
data_jags_fake <- list(
  N = n,
  K = k,
  wages = wages_fake,
  alpha = rep(1, k)
)

# ---- Step 2: Define JAGS Model ----

model_string <- "
model {
  for (i in 1:N) {
    age_group[i] ~ dcat(p[1:K])
    wages[i] ~ dnorm(mu[age_group[i]], tau)
  }

  p[1:K] ~ ddirch(alpha[1:K])

  mu[1] ~ dnorm(20, 1)
  mu[2] ~ dnorm(30, 1)
  mu[3] ~ dnorm(40, 1)
  mu[4] ~ dnorm(50, 1)

  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

# ---- Step 3: Run JAGS Model ----

inits <- function() {
  list(age_group = sample(1:k, n, replace = TRUE))
}

monitor_vars <- c("p", "mu", "tau", "sigma")

model_fake <- run.jags(
  model = model_string,
  data = data_jags_fake,
  inits = inits,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = FALSE,
  method = "rjags"
)

# ---- Step 4: Posterior Summary ----

posterior_draws <- as.data.frame(do.call(rbind, as.mcmc.list(model_fake)))

# -- Posterior for p
p_cols <- paste0("p[", 1:k, "]")
posterior_summary_p <- data.frame(
  parameter = p_cols,
  true_value = as.numeric(true_p),
  mean = colMeans(posterior_draws[, p_cols]),
  lower = apply(posterior_draws[, p_cols], 2, quantile, 0.025),
  upper = apply(posterior_draws[, p_cols], 2, quantile, 0.975)
)

# -- Posterior for mu
mu_cols <- paste0("mu[", 1:k, "]")
posterior_summary_mu <- data.frame(
  parameter = mu_cols,
  true_value = true_mu,
  mean = colMeans(posterior_draws[, mu_cols]),
  lower = apply(posterior_draws[, mu_cols], 2, quantile, 0.025),
  upper = apply(posterior_draws[, mu_cols], 2, quantile, 0.975)
)

# -- Posterior for tau and sigma
posterior_summary_tau_sigma <- data.frame(
  parameter = c("tau", "sigma"),
  true_value = c(true_tau, true_sigma),
  mean = colMeans(posterior_draws[, c("tau", "sigma")]),
  lower = apply(posterior_draws[, c("tau", "sigma")], 2, quantile, 0.025),
  upper = apply(posterior_draws[, c("tau", "sigma")], 2, quantile, 0.975)
)

# Combine mu, tau, sigma summaries
posterior_summary_all <- rbind(posterior_summary_mu, posterior_summary_tau_sigma)
posterior_summary_all$parameter <- factor(posterior_summary_all$parameter,
                                          levels = posterior_summary_all$parameter)

# ---- Step 5: Plots ----

# -- Plot for p
ggplot(posterior_summary_p, aes(x = mean, y = reorder(parameter, mean))) +
  geom_point(color = "black", size = 3) +
  geom_errorbarh(aes(xmin = lower, xmax = upper), height = 0.2, color = "red") +
  labs(title = "Posterior credible intervals for p (simulated data)",
       x = "Value", y = NULL) +
  theme_minimal()

# -- Plot for mu, tau, sigma
ggplot(posterior_summary_all, aes(x = mean, y = reorder(parameter, mean))) +
  geom_point(color = "black", size = 3) +
  geom_errorbarh(aes(xmin = lower, xmax = upper), height = 0.2, color = "red") +
  labs(title = "Posterior credible intervals for mu, tau, and sigma (simulated data)",
       x = "Value", y = NULL) +
  theme_minimal()


```

#Model + MCMC diagnostic (education)
```{r}
# ---- Data prep ----
Wage_data <- Wage_data %>% filter(wages > 0, education > 0)

data_jags_edu <- list(
  N = nrow(Wage_data),
  wages = Wage_data$wages,
  education = Wage_data$education
)

# ---- JAGS Model ----
model_string_edu <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu[i], tau)
    mu[i] <- beta0 + beta1 * education[i]
  }

  # Priors (Normal)
  beta0 ~ dnorm(0, 0.001)
  beta1 ~ dnorm(0, 0.001)

  # Prior on precision
  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

# ---- Initial values ----
inits_edu <- function() {
  list(beta0 = rnorm(1), beta1 = rnorm(1), tau = rgamma(1, 0.01, 0.01))
}

# ---- Parameters to monitor ----
monitor_vars <- c("beta0", "beta1", "tau", "sigma")

# ---- Run the model ----
model_edu <- run.jags(
  model = model_string_edu,
  data = data_jags_edu,
  inits = inits_edu,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = TRUE,
  method = "rjags"
)

# ---- Step 5: Summarize and extract samples ----

print(summary(model_edu))

mcmc_samples_edu <- as.mcmc.list(model_edu)
nchains <- length(mcmc_samples_edu)

samples_df_edu <- do.call(rbind, lapply(1:nchains, function(i) {
  df <- as.data.frame(mcmc_samples_edu[[i]])
  df$iteration <- 1:nrow(df)
  df$chain <- factor(paste0("Chain ", i))
  return(df)
}))

# ---- Step 6: Traceplots for beta0, beta1, tau, sigma ----

# Parameters to trace
target_params_edu <- c("beta0", "beta1", "tau", "sigma")

for (param in target_params_edu) {
  if (param %in% names(samples_df_edu)) {
    p <- ggplot(samples_df_edu, aes(x = iteration, y = .data[[param]], color = chain)) +
      geom_line() +
      labs(title = paste("Traceplot for", param),
           x = "Iteration", y = "Value") +
      theme_minimal()
    print(p)
  }
}


```
#Fake Data Check for education
```{r}
# ---- Libraries ----
library(runjags)
library(coda)
library(ggplot2)
library(dplyr)

# ---- Step 1: Simulate Fake Data ----

set.seed(42)

n <- 500
true_beta0 <- 5
true_beta1 <- 2
true_sigma <- 3
true_tau <- 1 / true_sigma^2

education_fake <- runif(n, 5, 20)  # Simulate education between 5 and 20
wages_fake <- rnorm(n, mean = true_beta0 + true_beta1 * education_fake, sd = true_sigma)

data_jags_fake <- list(
  N = n,
  wages = wages_fake,
  education = education_fake
)

# ---- Step 2: Define JAGS Model ----

model_string <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu[i], tau)
    mu[i] <- beta0 + beta1 * education[i]
  }

  beta0 ~ dnorm(0, 0.001)
  beta1 ~ dnorm(0, 0.001)
  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

# ---- Step 3: Run JAGS Model ----

inits <- function() {
  list(beta0 = rnorm(1), beta1 = rnorm(1), tau = rgamma(1, 1, 1))
}

monitor_vars <- c("beta0", "beta1", "tau", "sigma")

model_fake <- run.jags(
  model = model_string,
  data = data_jags_fake,
  inits = inits,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = FALSE,
  method = "rjags"
)

# ---- Step 4: Posterior Summaries ----

posterior_draws <- as.data.frame(do.call(rbind, as.mcmc.list(model_fake)))

true_vals <- c(true_beta0, true_beta1, true_tau, true_sigma)
params <- c("beta0", "beta1", "tau", "sigma")

posterior_summary <- data.frame(
  parameter = params,
  true_value = true_vals,
  mean = colMeans(posterior_draws[, params]),
  lower = apply(posterior_draws[, params], 2, quantile, 0.025),
  upper = apply(posterior_draws[, params], 2, quantile, 0.975)
)

# ---- Step 5: Plot Posterior vs True ----

ggplot(posterior_summary, aes(x = mean, y = reorder(parameter, mean))) +
  geom_point(color = "black", size = 3) +
  geom_errorbarh(aes(xmin = lower, xmax = upper), height = 0.2, color = "red") +
  labs(title = "Posterior credible intervals for beta0, beta1, tau, sigma (simulated data)",
       x = "Value", y = NULL) +
  theme_minimal()

```
#Model and MCMC diagnostics (occupation)
```{r}
library(runjags)
library(coda)
library(dplyr)
library(ggplot2)

# ---- Step 1: Prepare the data ----

Wage_data <- Wage_data %>%
  filter(!is.na(wages), !is.na(occupation), wages > 0)

Wage_data$occupation <- factor(Wage_data$occupation)
Wage_data$occ_index <- as.numeric(Wage_data$occupation)
occupation_levels <- levels(Wage_data$occupation)

# Constants
N <- nrow(Wage_data)
K <- length(occupation_levels)

data_jags_occ_fixed <- list(
  N = N,
  K = K,
  wages = Wage_data$wages,
  occ_index = Wage_data$occ_index
)

# ---- Step 2: JAGS model ----

model_string_occ_fixed <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu[occ_index[i]], tau)
  }

  for (k in 1:K) {
    mu[k] ~ dnorm(50, 1)
  }

  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

# ---- Step 3: MCMC setup ----

# No latent variables → simple inits
inits_occ <- function() {
  list(mu = rnorm(K, 50, 10), tau = rgamma(1, 1, 1))
}

monitor_vars <- c("mu", "tau", "sigma")

model_occ <- run.jags(
  model = model_string_occ_fixed,
  data = data_jags_occ_fixed,
  inits = inits_occ,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = TRUE,
  method = "rjags"
)

# ---- Step 4: Traceplots & summary ----

print(summary(model_occ))

mcmc_samples_occ <- as.mcmc.list(model_occ)

samples_df_occ <- do.call(rbind, lapply(1:length(mcmc_samples_occ), function(i) {
  df <- as.data.frame(mcmc_samples_occ[[i]])
  df$iteration <- 1:nrow(df)
  df$chain <- factor(paste0("Chain ", i))
  return(df)
}))

# ---- Plot traceplots for mu[1:K], tau, and sigma ----

target_params_occ <- c("tau", "sigma")

for (param in target_params_occ) {
  if (param %in% names(samples_df_occ)) {
    p <- ggplot(samples_df_occ, aes(x = iteration, y = .data[[param]], color = chain)) +
      geom_line(alpha = 0.5, linewidth = 0.4) +
      labs(title = paste("Traceplot for", param),
           x = "Iteration", y = "Value") +
      theme_minimal()
    print(p)
  }
}


```
#Fake data check for occupation 
```{r}
library(runjags)
library(coda)
library(dplyr)
library(ggplot2)

# ---- Step 1: Simulate Fake Data for 6 Occupation Groups ----

set.seed(42)

# Occupation labels (based on your dataset)
occupation_labels <- c("Clerical", "Management", "Other", "Professional", "Sales", "Service")
K <- length(occupation_labels)
n <- 500

# Set true wage means for each occupation group
true_mu <- c(30, 60, 40, 70, 25, 35)  # example true means

# Equal occupation proportions or use empirical ones
true_p <- rep(1 / K, K)

# Simulate occupation assignments
occ_fake <- sample(1:K, size = n, replace = TRUE, prob = true_p)

# Simulate wages based on group
true_sigma <- 5
true_tau <- 1 / true_sigma^2
wages_fake <- rnorm(n, mean = true_mu[occ_fake], sd = true_sigma)

# Prepare data for JAGS
data_jags_fake_occ <- list(
  N = n,
  K = K,
  wages = wages_fake,
  occ_index = occ_fake
)

# ---- Step 2: JAGS Model ----

model_string_occ <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu[occ_index[i]], tau)
  }

  for (k in 1:K) {
    mu[k] ~ dnorm(50, 0.001)
  }

  tau ~ dgamma(0.01, 0.01)
  sigma <- 1 / sqrt(tau)
}
"

inits_occ <- function() {
  list(mu = rnorm(K, 50, 10), tau = rgamma(1, 1, 1))
}

monitor_vars <- c("mu", "tau", "sigma")

model_fake_occ <- run.jags(
  model = model_string_occ,
  data = data_jags_fake_occ,
  inits = inits_occ,
  monitor = monitor_vars,
  n.chains = 3,
  adapt = 1000,
  burnin = 1000,
  sample = 5000,
  summarise = FALSE,
  method = "rjags"
)

# ---- Step 3: Posterior Summaries ----

posterior_draws <- as.data.frame(do.call(rbind, as.mcmc.list(model_fake_occ)))

mu_cols <- paste0("mu[", 1:K, "]")

posterior_summary_mu <- data.frame(
  parameter = mu_cols,
  occupation = occupation_labels,
  true_value = true_mu,
  mean = colMeans(posterior_draws[, mu_cols]),
  lower = apply(posterior_draws[, mu_cols], 2, quantile, 0.025),
  upper = apply(posterior_draws[, mu_cols], 2, quantile, 0.975)
)

# Tau and Sigma
posterior_summary_tau_sigma <- data.frame(
  parameter = c("tau", "sigma"),
  occupation = c("τ (precision)", "σ (std dev)"),
  true_value = c(true_tau, true_sigma),
  mean = colMeans(posterior_draws[, c("tau", "sigma")]),
  lower = apply(posterior_draws[, c("tau", "sigma")], 2, quantile, 0.025),
  upper = apply(posterior_draws[, c("tau", "sigma")], 2, quantile, 0.975)
)

# Combine all summaries
posterior_summary_all <- rbind(posterior_summary_mu, posterior_summary_tau_sigma)

# ---- Step 4: Plot ----

ggplot(posterior_summary_all, aes(x = mean, y = reorder(occupation, mean))) +
  geom_point(color = "black", size = 3) +
  geom_errorbarh(aes(xmin = lower, xmax = upper), height = 0.25, color = "red") +
  labs(title = "Posterior credible intervals (fake occupation data)",
       x = "Value", y = NULL) +
  theme_minimal()

```
##### Modélisation bayésienne des disparités de salaires par genre


```{r}
library(runjags)

model_string <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu_sex[sex[i]], tau)
  }
  for (j in 1:2) {
    mu_sex[j] ~ dnorm(0, 10)
  }
  tau <- pow(sigma, -2)
  sigma ~ dunif(0, 100)
}
"

data_jags <- list(
  wages = Wage_data$wages,
  sex = as.numeric(factor(Wage_data$female)),
  N = nrow(Wage_data),
  K = 2
)

inits <- function() {
  list(mu_sex = rnorm(2), sigma = runif(1))
}

parameters <- c("mu_sex", "sigma")

results_sex <- run.jags(model = model_string, data = data_jags, inits = inits, n.chains = 3, burnin = 1000, sample = 5000, monitor = parameters)

cat("Résultats du modèle JAGS pour la variable sex:\n")
as.data.frame(summary(results))

```
```{r}
plot_credible_intervals(results_sex)
```

```{r}

```


## Régression bayésienne

```{r pressure}

model_string_regression <- "
model {
  for (i in 1:N) {
    wages[i] ~ dnorm(mu[i], tau)
    mu[i] <- beta0 + beta1 * education[i] + beta2 * south[i] + beta3 * female[i] + beta4 * workexp[i] + beta5 * unionmember[i] + beta6 * age[i] + beta7 * ethnicity[i] + beta8 * occupation[i] + beta9 * sector[i] + beta10 * married[i]
  }
  beta0 ~ dnorm(0, 0.0001)
  beta1 ~ dnorm(0, 0.0001)
  beta2 ~ dnorm(0, 0.0001)
  beta3 ~ dnorm(0, 0.0001)
  beta4 ~ dnorm(0, 0.0001)
  beta5 ~ dnorm(0, 0.0001)
  beta6 ~ dnorm(0, 0.0001)
  beta7 ~ dnorm(0, 0.0001)
  beta8 ~ dnorm(0, 0.0001)
  beta9 ~ dnorm(0, 0.0001)
  beta10 ~ dnorm(0, 0.0001)
  tau <- pow(sigma, -2)
  sigma ~ dunif(0, 100)
}
"

data_jags_regression <- list(
  wages = Wage_data$wages,
  education = Wage_data$education,
  south = as.numeric(Wage_data$south),
  female = as.numeric(Wage_data$female),
  workexp = Wage_data$workexp,
  unionmember = as.numeric(Wage_data$unionmember),
  age = as.numeric(Wage_data$age),
  ethnicity = as.numeric(factor(Wage_data$ethnicity)),
  occupation = as.numeric(factor(Wage_data$occupation)),
  sector = as.numeric(factor(Wage_data$sector)),
  married = as.numeric(Wage_data$married),
  N = nrow(Wage_data)
)

inits_regression <- function() {
  list(beta0 = rnorm(1), beta1 = rnorm(1), beta2 = rnorm(1), beta3 = rnorm(1), beta4 = rnorm(1), beta5 = rnorm(1), beta6 = rnorm(1), beta7 = rnorm(1), beta8 = rnorm(1), beta9 = rnorm(1), beta10 = rnorm(1), sigma = runif(1))
}

parameters_regression <- c("beta0", "beta1", "beta2", "beta3", "beta4", "beta5", "beta6", "beta7", "beta8", "beta9", "beta10", "sigma")

results_regression <- run.jags(model = model_string_regression, data = data_jags_regression, inits = inits_regression, n.chains = 3, burnin = 1000, sample = 5000, monitor = parameters_regression)

summary(results_regression)

```

```{r}

```

```{r}

```



```{r}

```




